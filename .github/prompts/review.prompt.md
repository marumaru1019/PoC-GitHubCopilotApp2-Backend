---
mode: fullstack-reviewer
description: 実装されたコードを品質観点でレビューし、改善提案とブロッカーを報告する
---

# コードレビューワークフロー

## Context Loading Phase

コードレビューを開始する前に、必ず以下の情報を収集してください:

### 必須の事前確認

1. **変更差分の確認**
   - `#changes` ツールで変更されたファイルを確認
   - 変更内容を理解
   - 変更の意図を把握

2. **仕様書の確認**
   - `[仕様書フォルダ]/[機能名]/[機能名].spec.md` ファイルを読み込み
   - 仕様通りに実装されているか確認

3. **テスト結果の確認**
   - `#runTests` でテスト結果を確認
   - カバレッジレポートを確認
   - 失敗しているテストがないか確認

4. **問題の確認**
   - `#problems` で型エラー・リントエラーを確認
   - すべてのエラーが解決されているか確認

5. **プロジェクトルールの確認**
   - プロジェクト固有のルールに違反していないか確認

---

## Execution

以下の観点でレビュー:

### 1. 仕様との整合性
- [ ] 受け入れ条件をすべて満たしているか
- [ ] ユーザーストーリーに沿った実装か

### 2. コード品質
- [ ] コーディング規約に従っているか
- [ ] 適切なエラーハンドリングがあるか
- [ ] セキュリティ上の問題はないか

### 3. テスト
- [ ] テストが正常に動作するか
- [ ] カバレッジが十分か（目標: 80%以上）
- [ ] エッジケースをテストしているか

### 4. パフォーマンス
- [ ] 不要なレンダリング/クエリはないか
- [ ] 適切な最適化が行われているか

---

## Output

レビュー結果テンプレート（簡略版）:

\```markdown
## ✅ レビュー完了報告

### 検証結果
| 観点 | 結果 | コメント |
|------|------|----------|
| 仕様整合性 | ✅/⚠️/❌ | [コメント] |
| コード品質 | ✅/⚠️/❌ | [コメント] |
| テスト | ✅/⚠️/❌ | [コメント] |
| パフォーマンス | ✅/⚠️/❌ | [コメント] |

### 改善提案
- [改善が必要な場合のみ記載]

### 承認判定
- ✅ **承認** - 本番環境へのデプロイ可能
- ⚠️ **条件付き承認** - 軽微な修正後にデプロイ可能
- ❌ **却下** - 重大な問題があり、再実装が必要
\```

---

## Validation Gate

🚨 **STOP** - レビュー結果を確認してください

\```markdown
## 📋 レビュー結果

[上記の形式でのレビュー結果]

---

### 次のアクション
- ✅ **承認の場合**: 完了
- ⚠️ **条件付き承認**: 軽微な修正を実施
- ❌ **却下の場合**: `/implement` で再実装
\```

### ⚠️ 重要な注意事項

- ブロッカーが存在する場合は、承認を推奨しないでください
- 改善提案はオプションですが、セキュリティ関連は強く推奨してください
- ユーザーが承認した場合のみ、完了とみなしてください
