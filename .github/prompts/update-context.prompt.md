---
description: 実装内容をコンテキストファイルに自動反映する
---

# コンテキスト更新ワークフロー

## Steps

### Step 1: Context Loading
以下の情報を収集:

1. **実装計画書の確認**
   - `[仕様書フォルダ]/[機能名]/[機能名].plan.md` を読み込み

2. **変更内容の確認**
   - `#changes` で実装済みの変更を確認

3. **既存コンテキストファイルの読み込み**
   - フロントエンド、バックエンドそれぞれの docs/context フォルダ内のコンテキストファイルを読み込み
   - フロントエンドフォルダ/docs/context/api-overview.context.md
   - フロントエンドフォルダ/docs/context/auth-flow.context.md
   - バックエンドフォルダ/docs/context/api-specification.context.md

### Step 2: Analysis & Identification
実装計画書と変更内容を分析し、更新が必要なコンテキストファイルを特定:

1. **API変更の検出**
   - 新しいエンドポイント、パラメータ、レスポンス形式の追加
   - → `api-specification.context.md` を更新

2. **認証要件の確認**
   - 保護されたルートの追加
   - → `auth-flow.context.md` を更新

3. **データベース変更の検出**
   - テーブル追加、カラム追加、インデックス追加
   - → `database-schema.context.md` を更新

4. **その他の変更**
   - アーキテクチャ変更、新しいパターン導入など

### Step 3: Structured Output
更新内容をレビュー可能な形式で提示:

\```markdown
## 📋 コンテキストファイル更新計画

### 🔍 検出された変更

#### バックエンド変更
- **[エンドポイント名]**: [変更内容]
  - ファイル: `[ファイルパス]`
  - 内容: [詳細]

#### フロントエンド変更
- **[コンポーネント名]**: [変更内容]
  - ファイル: `[ファイルパス]`
  - 機能: [詳細]

---

### 📝 更新対象ファイル

#### 1. api-specification.context.md
**更新箇所:** [セクション名]
**追加内容:**
\```markdown
[具体的な追記内容をマークダウン形式で記載]
\```

#### 2. database-schema.context.md
**更新箇所:** [テーブル名]
**追加内容:**
\```markdown
[具体的な追記内容をマークダウン形式で記載]
\```

#### 3. 更新不要
- ✅ `[ファイル名]`: [理由]
\```

### Step 4: Validation Gate (🚨 STOP)
**ここで必ずユーザーの承認を待つ**

更新計画を提示し、内容を確認してもらう:
- [ ] API仕様の追記内容が正確か
- [ ] データベーススキーマの変更が正確か
- [ ] 不要な更新が含まれていないか
- [ ] 既存の情報と矛盾がないか

- ✅ **承認された場合**: Step 5へ進む
- ❌ **修正が必要な場合**: Step 2に戻る

### Step 5: File Update
承認後、コンテキストファイルを一括更新:

- 各コンテキストファイルに変更内容を追記
- 既存の情報と矛盾がないか確認
- 更新日時を記録

**完了報告:**

\```markdown
✅ コンテキストファイル更新完了

### 📊 更新サマリー
| ファイル | 更新内容 | 状態 |
|---------|---------|------|
| api-specification.context.md | [変更内容] | ✅ 完了 |
| database-schema.context.md | [変更内容] | ✅ 完了 |

### 🚀 次のステップ
これらの更新されたコンテキストファイルは、次の機能開発時に自動的に参照されます。
\```
